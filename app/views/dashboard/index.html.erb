<div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
  <% if current_user.admin? %>
    <div class="bg-gradient-to-r from-blue-600 to-blue-800 rounded-2xl shadow-xl p-8 mb-8">
      <h2 class="text-4xl font-bold text-white mb-8 flex items-center">
        <svg class="w-10 h-10 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z" clip-rule="evenodd"/>
        </svg>
        Admin Dashboard
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
          <p class="text-blue-100 text-sm font-medium mb-2">Total Users</p>
          <p class="text-3xl font-bold text-white"><%= @total_users %></p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
          <p class="text-blue-100 text-sm font-medium mb-2">Total Stores</p>
          <p class="text-3xl font-bold text-white"><%= @total_stores %></p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
          <p class="text-blue-100 text-sm font-medium mb-2">Total Ratings</p>
          <p class="text-3xl font-bold text-white"><%= @total_ratings %></p>
        </div>
      </div>
      
    </div>
    <div class="flex flex-wrap gap-4 mb-8">
  <%= link_to "All Users", admin_users_path,
      class: "bg-white text-blue-700 font-semibold px-4 py-2 rounded-lg shadow hover:bg-blue-50 transition" %>

  <%= link_to "Create User", new_admin_user_path,
      class: "bg-white text-green-700 font-semibold px-4 py-2 rounded-lg shadow hover:bg-green-50 transition" %>

  <%= link_to "All Stores", admin_stores_path,
      class: "bg-white text-indigo-700 font-semibold px-4 py-2 rounded-lg shadow hover:bg-indigo-50 transition" %>

  <%# Optional: You can create a separate UI for store creation if admin can do that %>
<%= link_to "Create Store", new_admin_store_path,
  class: "bg-white text-purple-700 font-semibold px-4 py-2 rounded-lg shadow hover:bg-purple-50 transition" %>



  <% elsif current_user.store_owner? %>
    <div class="bg-gradient-to-r from-purple-600 to-purple-800 rounded-2xl shadow-xl p-8 mb-8">
      <h2 class="text-4xl font-bold text-white mb-8 flex items-center">
        <svg class="w-10 h-10 mr-3" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h4a2 2 0 012 2v2a2 2 0 01-2 2H8a2 2 0 01-2-2v-2z" clip-rule="evenodd"/>
        </svg>
        Store Owner Dashboard
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
          <p class="text-purple-100 text-sm font-medium mb-2">Store Name</p>
          <p class="text-2xl font-bold text-white"><%= @store.name %></p>
        </div>
        <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20">
          <p class="text-purple-100 text-sm font-medium mb-2">Average Rating</p>
          <p class="text-2xl font-bold text-white"><%= @store.average_rating %> ‚≠ê</p>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-2xl shadow-xl p-8">
      <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
        <svg class="w-8 h-8 mr-3 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
        </svg>
        User Ratings
      </h3>
      <div class="space-y-3">
        <% @ratings.each do |rating| %>
          <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200">
            <span class="font-medium text-gray-800"><%= rating.user.name %></span>
            <div class="flex items-center">
              <% rating.value.times do %>
                <svg class="w-5 h-5 text-yellow-400 mr-1" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
                </svg>
              <% end %>
              <span class="ml-2 text-lg font-semibold text-gray-700"><%= rating.value %></span>
            </div>
          </div>
        <% end %>
      </div>
    </div>

  <% else %>
    <!-- User Dashboard Header -->
    <div class="bg-gradient-to-r from-green-600 to-emerald-700 rounded-2xl shadow-xl p-8 mb-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <div class="mb-6 sm:mb-0">
          <h2 class="text-4xl font-bold text-white mb-2 flex items-center">
            <svg class="w-10 h-10 mr-3" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
            </svg>
            User Dashboard
          </h2>
          <p class="text-green-100 text-lg">Discover and rate amazing stores</p>
        </div>
        <%= link_to stores_path, class: "inline-flex items-center px-6 py-3 bg-white text-green-700 font-semibold rounded-xl hover:bg-green-50 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1" do %>
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
          </svg>
          View All Stores
        <% end %>
      </div>
    </div>

    <!-- Store Cards Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
      <% @stores.each do |store| %>
        <div class="bg-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border border-gray-100 overflow-hidden">
          <!-- Store Header -->
          <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 border-b border-gray-100">
            <h3 class="text-2xl font-bold text-gray-800 mb-3 flex items-center">
              <svg class="w-6 h-6 mr-2 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h4a2 2 0 012 2v2a2 2 0 01-2 2H8a2 2 0 01-2-2v-2z" clip-rule="evenodd"/>
              </svg>
              <%= store.name %>
            </h3>
            
            <!-- Average Rating Display -->
            <div class="mb-4">
              <p class="text-sm font-medium text-gray-600 mb-2">Average Rating</p>
              <div class="flex items-center">
                <% average = store.average_rating.to_f.round %>
                <div class="flex mr-3">
                  <% 5.times do |i| %>
                    <% if i < average %>
                      <svg class="w-6 h-6 text-yellow-400 drop-shadow-sm" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
                      </svg>
                    <% else %>
                      <svg class="w-6 h-6 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
                      </svg>
                    <% end %>
                  <% end %>
                </div>
                <span class="text-xl font-bold text-gray-700 bg-white px-3 py-1 rounded-full shadow-sm">
                  <%= store.average_rating.round(1) %>
                </span>
              </div>
            </div>
          </div>

          <!-- User Rating Section -->
          <div class="p-6">
            <div class="mb-6">
              <p class="text-sm font-medium text-gray-600 mb-3">Your Rating</p>
              <% user_rating = @user_ratings[store.id]&.value %>
              <div class="flex items-center mb-4">
                <% rating = user_rating || 0 %>
                <div class="flex mr-3">
                  <% 5.times do |i| %>
                    <% if i < rating %>
                      <svg class="w-6 h-6 text-green-500 drop-shadow-sm" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
                      </svg>
                    <% else %>
                      <svg class="w-6 h-6 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.975a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.39 2.462a1 1 0 00-.364 1.118l1.286 3.974c.3.922-.755 1.688-1.54 1.118L10 13.347l-3.39 2.462c-.784.57-1.838-.196-1.54-1.118l1.286-3.974a1 1 0 00-.364-1.118L3.602 9.402c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.69l1.286-3.975z"/>
                      </svg>
                    <% end %>
                  <% end %>
                </div>
                <% if rating == 0 %>
                  <span class="text-gray-400 italic font-medium bg-gray-100 px-3 py-1 rounded-full text-sm">Not rated</span>
                <% else %>
                  <span class="text-lg font-bold text-green-600 bg-green-100 px-3 py-1 rounded-full">
                    <%= rating %>
                  </span>
                <% end %>
              </div>
            </div>

            <!-- Rating Actions -->
            <div class="space-y-3">
              <%= form_with url: store_ratings_path(store), method: :post, local: true, class: "flex items-center space-x-3" do %>
                <%= hidden_field_tag :store_id, store.id %>
                <div class="flex-1">
                  <%= number_field_tag :value, nil, in: 1..5, placeholder: "1-5",
                        class: "w-full px-4 py-3 border-2 border-green-200 rounded-xl text-center text-lg font-semibold focus:border-green-500 focus:outline-none focus:ring-2 focus:ring-green-200 transition-all duration-200" %>
                </div>
                <%= submit_tag "Rate Store", 
                      class: "px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white font-semibold rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5" %>
              <% end %>

              <% if user_rating %>
                <div class="flex justify-center">
                  <%= form_with url: clear_store_ratings_path(store), method: :delete, local: true do %>
                    <%= hidden_field_tag :store_id, store.id %>
                    <%= submit_tag "Clear Rating", 
                          class: "px-6 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white font-medium rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 shadow-md hover:shadow-lg text-sm" %>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Empty State -->
    <% if @stores.empty? %>
      <div class="text-center py-16">
        <svg class="w-24 h-24 text-gray-300 mx-auto mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
        </svg>
        <h3 class="text-2xl font-semibold text-gray-600 mb-2">No stores available</h3>
        <p class="text-gray-500">Check back later for new stores to discover and rate.</p>
      </div>
    <% end %>

  <% end %>
</div>